# Fire Detection Branch Configuration
# Pipeline: PGIE (fire/smoke/person) → nvtracker → SGIE (helmet) → OSD → sink

params:
  log_interval: 1.0
  stats_interval: 10.0
  max_age: 30
  # Per-camera configuration
  cameras:
    plate_cam:
      hat: True           # Enable helmet detection for this camera
      fire_smoke: True    # Enable fire/smoke visualization
    plate_cam2:
      hat: False          # Disable helmet detection for this camera
      fire_smoke: True    # Enable fire/smoke visualization
sink:
  enable: true
  type: filesink
  properties:
    location: "${OUTPUT_DIR:data/fire/output_fire.avi}"
    sync: false
    qos: false

muxer:
  batch-size: 8
  width: 1920
  height: 1080
  nvbuf-memory-type: 0
  batched-push-timeout: 40000
  live-source: 1

elements:
  - type: queue
  - type: nvvideoconvert
    name: pre_tiler_conv
    properties: { nvbuf-memory-type: 3 }
  - type: capsfilter
    name: rgba_caps
    caps: "video/x-raw(memory:NVMM), format=RGBA"
  - type: nvinfer
    name: pgie
    config_file: "data/roi/config_pgie_fire.txt"
  - type: nvtracker
    name: tracker
    config_file: "data/face/models/NvDCF/config_tracker.txt"
    probes: {src: tracker_probe}
  - type: nvinfer
    name: sgie_helmet
    config_file: "data/hat/config_sgie_helmet.txt"
    probes: {src: sgie_probe}
  - type: nvmultistreamtiler
    properties: { rows: 2, columns: 2, width: 1920, height: 1080 }
  - type: nvdsosd
    properties: { process-mode: 0, display-text: 1 }
    probes: {src: fire_fps_probe}
