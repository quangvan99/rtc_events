# Add cameras via proxy (port 9001, NOT 9000)
curl -X POST 'http://localhost:9001/api/v1/stream/add' \
  -H 'Content-Type: application/json' \
  -d '{"value":{"camera_id":"cam1","camera_url":"file:///home/mq/disk2T/quangnv/face/data/videos/change_id.mp4","change":"camera_add"}}'

curl -X POST 'http://localhost:9001/api/v1/stream/add' \
  -H 'Content-Type: application/json' \
  -d '{"value":{"camera_id":"cam2","camera_url":"file:///home/mq/disk2T/quangnv/face/data/videos/change_id.mp4","change":"camera_add"}}'

curl -X POST 'http://localhost:9001/api/v1/stream/add' \
  -H 'Content-Type: application/json' \
  -d '{"value":{"camera_id":"cam3","camera_url":"file:///home/mq/disk2T/quangnv/face/data/videos/change_id.mp4","change":"camera_add"}}'

curl -X POST 'http://localhost:9001/api/v1/stream/add' \
  -H 'Content-Type: application/json' \
  -d '{"value":{"camera_id":"cam4","camera_url":"file:///home/mq/disk2T/quangnv/face/data/videos/change_id.mp4","change":"camera_add"}}'


# List cameras
curl http://localhost:9001/api/v1/cameras

# Remove camera
curl -X POST 'http://localhost:9001/api/v1/stream/remove' \
  -H 'Content-Type: application/json' \
  -d '{"value":{"camera_id":"cam1","change":"camera_remove"}}'


  # Start pipeline with API
  python bin/run_multi_branch.py --config configs/multi-branch.yaml --port 8080

  # Add camera via API
  curl -X POST http://localhost:8080/api/cameras \
    -H "Content-Type: application/json" \
    -d '{"camera_id": "cam1", "uri": "file:///home/mq/disk2T/quangnv/face/data/videos/change_id.mp4", "branches": ["recognition", "detection"]}'

  # List cameras
  curl http://localhost:8080/api/cameras
=====================================
Hay danh gia muc do de dung khi di tu config
Toi dang muon tu projectbase nay, sau do phat trien cac bai toan AI khac, vi du nhan dien bien so xe 
sau do de xuat huong codebase sao cho de phat trien, de maintain, de them module khac

Giúp tôi thêm chức năng cho việc quản lý camera (CRUD) vào pipeline
Ví dụ có thể add video, rtsp lúc pipeline đang chạy 


Giúp tôi thêm chức năng cho việc quản lý camera (CRUD) vào pipeline
Ví dụ có thể add video, rtsp lúc pipeline đang chạy 

giúp tôi tự test end-to-end
xuất ra file output mp4 là được để tôi có thể thấy qúa trình CRUD của bạn
Lưu ý chỉ cần chạy video: @data/videos (vì rtsp tôi chưa bật)
ngoài ra test trên docker **face-stream**, root path là /home/mq/disk2T/quangnv/face/data/videos

/code @plans/20260108-2320-nvurisrcbin-tee-multi-branch/plan.md
  Please help me fully implement **all phases**, starting from **Phase 1**.
  * All phases should proceed **automatically**.
  * Please **remove the User Approval step**.
  * **Each phase must be implemented, tested, and fixed** before proceeding to the next phase.
  * Use the Docker **face-stream**, sau do cd /home/mq/disk2T/quangnv/face to debug, dev and fix. 


docker exec -it face-stream bash
python3 bin/test_camera_crud_webrtc.py
Khi toi them camera moi thi OSD va tiler len bi sai, hay check lai logic phan nay




Giờ tôi có sẵn 1 pipeline chạy sẵn 2 bài toán:
    - 1 nhánh detect face recognition  (đã có sẵn ): @face/apps/face
    - 1 nhánh đơn giản chỉ face detection.

Hãy giúo tôi phát triển chức năng có thể quản lý camera (CRUD) trên 1 nhánh, mà pipeline đang chạy đó.
ví dụ: toi co 3 camera, trong lúc 2 nhánh đang chạy thi toi add camera 1,2 cho nhanh 1, va camera 3 cho nhanh 2. 
Sau do lai xoa camera 1 cho nhanh 1

------------------------
Hãy phát triển cho tôi 2 chức năng:
    - 1 pipeline deeptream mà có thể chạy được nhiều nhánh (tương ứng với các bài toán). 
        ví dụ:1 nhánh detect face recognition  (đã có sẵn ): @face/apps/face, 1 nhánh đơn giản chỉ face detection.
    - chức năng có thể quản lý camera (CRUD) trên 1 nhánh mà pipeline đang chạy đó.
        ví dụ: toi co 3 camera, trong lúc 2 nhánh đang chạy thi toi add camera 1,2 cho nhanh 1, va camera 3 cho nhanh 2. 
        Sau do lai xoa camera 1 cho nhanh 1
    - Hay can nhac truong hop nvstreamdemux sau nvmultiurisrcbin thi loi nhan buffer.
    Hay research them truong hop moi source la 1 nvurisrcbin sao cho moi camera chi decode 1 lan, nhung co the su dung cho nhieu branch, sau do nvstreamux  
Ghi file brainstorm xuống file md 


Co cach nao de OSD truoc tiler khong?
Vi toi thay thuong OSD truoc tiler.
Vi OSD sau thi phai code logic rat nhieu
docker exec -it face-stream bash
python3 bin/test_camera_crud_webrtc.py
hay tu dong chay python3 bin/test_camera_crud_webrtc.py Use the Docker **face-stream** to debug, dev and fix. 

Co cach nao de OSD truoc tiler khong?
Vi toi thay thuong OSD truoc tiler


docker exec -it face-stream bash
python3 bin/test_camera_crud_webrtc.py
Hien tai khi toi add camera thu 2 thi no ve boundingbox len camera thu nhat. Co the la su dung curl nen no khong biet la ve len source nao. Ban hay giup toi viet them logic hoac viet api de fix loi tren


/home/mq/disk2T/quangnv/face/plans/reports/brainstorm-260108-multi-branch-pipeline.md

/plan:hard đọc file @plans/20260108-2215-nvstreammux-fanout-multi-branch/reports/brainstorm-260108-per-branch-camera-management.md, sau đó cho tôi comprehensive plan cho Approach 4 (nvurisrcbin + tee)


/home/mq/disk2T/quangnv/face/plans/20260108-2320-nvurisrcbin-tee-multi-branch/plan.md


tao 1 file test 1 pipeline chạy sẵn 2 bài toán:
    - 1 nhánh detect face recognition  (đã có sẵn ): @face/apps/face
    - 1 nhánh đơn giản chỉ face detection.
    - output moi branch la 1 video de toi thay dc su thay doi cua viec add camera cho branch
    - file test de trong folder @bin

sau do toi se tu curl camera (nho huong dan toi su dung api curl de CRUD camera vao branch)

 sua lai bin/test_multi_branch_video.py su dung file yaml  